"use strict";var _slicedToArray=function(){function e(e,t){var s=[],a=!0,r=!1,n=undefined;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(e){r=!0,n=e}finally{try{!a&&l["return"]&&l["return"]()}finally{if(r)throw n}}return s}return function(t,s){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,s);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),swiftypeSearchApp={apiUrl:"https://search-api.swiftype.com/api/v1/public/engines/search.json",params:{engine_key:"sJs4c2q1zN-FMUq8JhEg",q:"",page:1,per_page:5,filters:{}},resultsPageQuery:"",assetTypes:{LandingPage:"Website Pages",Glossary:"Glossary",Learning:"Learning",Notice:"Notices",BlogPost:"Blog Posts",Webinar:"Webinars"},filters:{learning:["Glossary","BlogPost","Learning"],webinars:"Webinar",notices:"Notice",landingPages:"LandingPage"},keyCodeExceptions:[9,16,17,18,20,27,37,38,39,40,45,91],$menuSearchButton:document.querySelector(".ndx-menu-search__button"),$mobileSearchMenuLink:document.querySelector(".ndx-mobile-search-link"),$modalScreen:document.querySelector(".ndx-modal-search"),$modalSearchWrapper:document.querySelector(".ndx-modal-search__wrapper"),$modalSearchInput:document.querySelector(".ndx-modal-search__input"),$learningSearchInput:document.querySelector(".ndx-learning-search > input"),$learningSearchButton:document.querySelector(".ndx-learning-search > button"),$modalSearchClearButton:document.querySelector(".ndx-modal-search__button-clear"),$modalSearchSearchButton:document.querySelector(".ndx-modal-search__button-search"),$modalSearchResults__menu:document.getElementById("ndx-modal-results__menu"),$modalSearchResults__learning:document.getElementById("ndx-modal-results__learning"),$modalSearchResults__searching:document.getElementById("ndx-modal-results__searching"),modalSearchNoResultsSelector:".ndx-modal-results__no-results",modalSearchSeeAllSelector:".ndx-modal-results__see-all",$resultsPageHeader:document.querySelector(".ndx-results-page__header"),$resultsPageInput:document.querySelector(".ndx-search-input-wrapper__input"),$resultsPageSearchButton:document.querySelector(".ndx-search-input-wrapper__button-search"),$resultsPageFiltersButtons:document.getElementsByClassName("ndx-results-page__filters-item"),$resultsPageNoResults:document.querySelector(".ndx-results-page__no-results"),$resultsPageResultsWrapper:document.querySelector(".ndx-results-page__results"),$resultsPagePaginationWrapper:document.querySelector(".ndx-results-page__pagination"),$resultsPagePaginationPrev:document.querySelector(".ndx-results-page__pagination-previous"),$resultsPagePaginationNext:document.querySelector(".ndx-results-page__pagination-next"),$resultsPagePaginationItems:document.getElementsByClassName("ndx-results-page__pagination-item"),$resultsPageInformation:document.querySelector(".ndx-results-page__info"),resultsPageUri:"/searching/",modalDelayTimer:!1,modalDelayTime:600,run:function(){this.startMenuButtonListener(),this.startMenuCloseActionListener(),this.startModalInputListener(),this.startModalClearButtonListener(),this.startSearchButtonListener(this.$modalSearchSearchButton),this.startModalItemsClickEventListener(),"/learning/"==location.pathname&&(this.startInputListener(this.$learningSearchInput,this.$modalSearchResults__learning,{page:{asset_type:this.filters.learning}}),this.startCloseActionListener(this.$learningSearchInput,this.$modalSearchResults__learning,".ndx-learning-search, #ndx-modal-results__learning"),this.startSearchButtonListener(this.$learningSearchButton)),location.pathname==this.resultsPageUri&&(window.assetType=this.assetTypes,this.startInputListener(this.$resultsPageInput,this.$modalSearchResults__searching),this.startSearchButtonListener(this.$resultsPageSearchButton),this.startCloseActionListener(this.$resultsPageInput,this.$modalSearchResults__searching,".ndx-results-page__input-wrapper, #ndx-modal-results__searching"),this.resultsPageStart(),this.resultsPageStartFiltersButtonsListener(),this.resultsPageStartPaginationListener())},resultsPageStart:function(){var e=this.getParamValue("q");this.resultsPageQuery=e;var t=this.getParamValue("filter");t=!(!t||!this.filters[t])&&t,this.$resultsPageHeader.innerHTML="Results for '"+e+"'",this.$resultsPageInput.value=e,t&&(this.resultsPageRemoveActiveClassFromFilters(),document.querySelector(".ndx-results-page__filters-item[data-filter="+t+"]").classList.add("active")),this.resultsPageGetResults(1,25,t)},resultsPageGetResults:function(){var e=arguments.length<=0||arguments[0]===undefined?1:arguments[0],t=this,s=arguments.length<=1||arguments[1]===undefined?25:arguments[1],a=!(arguments.length<=2||arguments[2]===undefined)&&arguments[2];this.params.q=this.resultsPageQuery,this.params.page=e,this.params.per_page=s,a&&"all"!=a?a&&"current"!=a&&(this.params.filters={page:{asset_type:this.filters[a]}},this.pushEventTrackingDataLayer({event:"search_interaction",event_category:"site search",event_action:"filter",event_label:a,event_value:undefined,interaction_type:"filter",interaction_value:a,search_term:this.params.q})):this.params.filters={},this.getResults(this.apiUrl,"?"+this.prepareQuery(this.params)).then(function(e){t.resultsPageShowResults(e)},function(){console.error("Swiftype search connection error.")})},resultsPageShowResults:function(e){if(0==e.info.page.num_pages)return this.$resultsPageResultsWrapper.classList.add("hide"),this.$resultsPageInformation.classList.add("hide"),this.$resultsPagePaginationWrapper.classList.add("hide"),this.$resultsPageNoResults.classList.remove("hide"),!1;var t="",s=this;Array.from(e.records.page).forEach(function(e){var a=""==e.image?'<img src="/images/Nadex-200x200.png" alt="'+e.title+'">':'<img src="'+e.image+'" alt="'+e.title+'">',r=e.asset_type?'<span class="ndx-results-page__results-item-content-assetType">'+window.assetType[e.asset_type]+"</span>":"",n=e.publication_date&&"LandingPage"!=e.asset_type?'<span class="ndx-results-page__results-item-content-date">'+s.getStringDate(new Date(e.publication_date))+"</span>":"",i=undefined;i="undefined"!=typeof e.description?e.description:e.body.split(" ").slice(0,50).join(" ")+"...",t+='<a class="ndx-results-page__results-item grid-x" href="'+e.url+'">\n        <div class="ndx-results-page__results-item-img columns large-2 text-center">\n          '+a+'\n        </div>\n        <div class="ndx-results-page__results-item-content columns large-10">\n          '+r+'\n          <p class="ndx-results-page__results-item-content-title">'+e.title+"</p>\n          "+n+'\n          <p class="ndx-results-page__results-item-content-body">'+i+"</p>\n        </div>\n      </a>"}),1==e.info.page.num_pages?(this.$resultsPageInformation.classList.add("hide"),this.$resultsPagePaginationWrapper.classList.add("hide")):(this.$resultsPageInformation.classList.remove("hide"),this.$resultsPagePaginationWrapper.classList.remove("hide"),this.resultsPagePaginationUpdating(e.info.page)),this.$resultsPageResultsWrapper.innerHTML=t,this.$resultsPageNoResults.classList.add("hide"),this.$resultsPageResultsWrapper.classList.remove("hide"),this.startResultsPageItemsClickEventListener()},resultsPageStartFiltersButtonsListener:function(){var e=this;Array.from(e.$resultsPageFiltersButtons).forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),e.resultsPageRemoveActiveClassFromFilters(),t.target.classList.add("active"),e.resultsPageGetResults(1,25,t.target.getAttribute("data-filter"))})})},resultsPageRemoveActiveClassFromFilters:function(){var e=this;Array.from(e.$resultsPageFiltersButtons).forEach(function(e){e.classList.remove("active")})},resultsPageStartPaginationListener:function(){var e=this;this.$resultsPagePaginationPrev.addEventListener("click",function(t){t.preventDefault(),t.target.classList.contains("disable")||e.resultsPageGetResults(parseInt(e.params.page)-1,25,"current")}),this.$resultsPagePaginationNext.addEventListener("click",function(t){t.preventDefault(),t.target.classList.contains("disable")||e.resultsPageGetResults(parseInt(e.params.page)+1,25,"current")});var t=this;Array.from(t.$resultsPagePaginationItems).forEach(function(e){e.addEventListener("click",function(e){if(e.preventDefault(),e.target.classList.contains("disable")||e.target.classList.contains("hide"))return!1;var s=e.target.getAttribute("data-page");t.resultsPageGetResults(s,25,"current")})})},resultsPagePaginationUpdating:function(e){1==e.current_page?this.$resultsPagePaginationPrev.classList.add("disable"):this.$resultsPagePaginationPrev.classList.remove("disable"),e.current_page==e.num_pages?this.$resultsPagePaginationNext.classList.add("disable"):this.$resultsPagePaginationNext.classList.remove("disable");for(var t=Math.ceil(e.current_page/4)-1,s=0;s<4;s++){this.$resultsPagePaginationItems[s].classList.remove("disable","hide");var a=4*t+s+1;this.$resultsPagePaginationItems[s].innerHTML=a,this.$resultsPagePaginationItems[s].setAttribute("data-page",a),a==e.current_page&&this.$resultsPagePaginationItems[s].classList.add("disable"),a>e.num_pages&&this.$resultsPagePaginationItems[s].classList.add("hide")}document.body.scrollIntoView({behavior:"smooth",block:"start"}),this.resultsPageInfoUpdating(e)},resultsPageInfoUpdating:function(e){var t=1==e.current_page?1:25*(e.current_page-1)+1,s=e.current_page==e.num_pages?e.total_result_count:25*e.current_page;this.$resultsPageInformation.innerHTML="Showing results "+t+"-"+s+" out of "+e.total_result_count},startResultsPageItemsClickEventListener:function(){var e=arguments.length<=0||arguments[0]===undefined?"ndx-results-page__results-item":arguments[0],t=this,s=document.getElementsByClassName(e),a=t.params.q,r=!0,n=!1,i=undefined;try{for(var l,o=function(){var e=l.value;e.addEventListener("click",function(s){s.preventDefault();var r=e.getAttribute("href"),n=e.querySelector(".ndx-results-page__results-item-content-title").innerText;t.pushEventTrackingDataLayer({event:"select_search_result",event_category:"site search",event_action:"select serp result",event_label:n,event_value:undefined,suggested_result:n,auto_or_serp:"serp",search_term:a}).then(function(){window.location.href=r},function(){console.error("Data layer adding error.")})})},u=s[Symbol.iterator]();!(r=(l=u.next()).done);r=!0)o()}catch(e){n=!0,i=e}finally{try{!r&&u["return"]&&u["return"]()}finally{if(n)throw i}}},startInputListener:function(e,t){var s=this,a=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];e.addEventListener("keyup",function(e){if(s.checkIfkeyCodeException(e.keyCode))return!1;clearTimeout(s.modalDelayTimer),s.params.q=e.target.value,e.target.value.length>2?function(){var r=s;s.modalDelayTimer=setTimeout(function(){t.classList.remove("hide"),r.modalSearchAction(e.target.value,t,a)},r.modalDelayTime)}():t.classList.add("hide"),"Enter"===e.key&&""!=e.target.value&&s.openAllResultsPage()})},getParamValue:function(e){var t=new URL(window.location.href);return this.stripHtml(t.searchParams.get(e))},getResults:function(e,t){return new Promise(function(s,a){var r=new XMLHttpRequest;r.onreadystatechange=function(){4==this.readyState&&200==this.status?s(JSON.parse(this.responseText)):4==this.readyState&&200!=this.status&&a(new Error("Can't get the results."))},r.open("GET",e+t,!0),r.setRequestHeader("Content-Type","application/json"),r.send()})},startMenuButtonListener:function(){var e=this;[this.$menuSearchButton,this.$mobileSearchMenuLink].forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),e.showModal(),e.$modalSearchInput.focus()})})},startMenuCloseActionListener:function(){var e=this;this.$modalSearchWrapper.addEventListener("click",function(t){t.stopPropagation(),e.$modalSearchInput.focus()}),this.$modalSearchResults__menu.addEventListener("click",function(e){e.stopPropagation()}),this.$modalScreen.addEventListener("click",function(){e.hideModal()})},startModalInputListener:function(){var e=this;this.$modalSearchInput.addEventListener("keyup",function(t){if(e.checkIfkeyCodeException(t.keyCode))return!1;clearTimeout(e.modalDelayTimer),e.params.q=t.target.value,t.target.value.length>0?e.$modalSearchClearButton.classList.remove("visibility-hidden"):e.$modalSearchClearButton.classList.add("visibility-hidden"),t.target.value.length>2?function(){var s=e;e.modalDelayTimer=setTimeout(function(){s.$modalSearchResults__menu.classList.remove("hide"),s.modalSearchAction(t.target.value,s.$modalSearchResults__menu)},s.modalDelayTime)}():e.$modalSearchResults__menu.classList.add("hide"),"Enter"===t.key&&""!=t.target.value&&e.openAllResultsPage()})},startModalClearButtonListener:function(){var e=this;this.$modalSearchClearButton.addEventListener("click",function(){e.clearAction(e.$modalSearchInput,e.$modalSearchResults__menu)})},startCloseActionListener:function(e,t,s){var a=this;window.addEventListener("click",function(){t.classList.add("hide"),a.clearAction(e,t)}),document.querySelector(s).addEventListener("click",function(e){e.stopPropagation()})},startSearchButtonListener:function(e){var t=this;e.addEventListener("click",function(){""!=t.params.q&&t.openAllResultsPage()})},showModal:function(){var e=this;this.$modalSearchInput.value="",window.scrollTo(0,0),this.$modalScreen.classList.remove("hide"),document.body.classList.add("overflow-hidden"),setTimeout(function(){e.$modalSearchWrapper.classList.remove("inactive")},50)},hideModal:function(){var e=this;this.$modalSearchWrapper.classList.add("inactive"),this.$modalSearchResults__menu.classList.add("hide"),setTimeout(function(){e.$modalScreen.classList.add("hide"),document.body.classList.remove("overflow-hidden"),e.clearAction(e.$modalSearchInput,e.$modalSearchResults__menu)},250)},clearAction:function(e,t){this.$modalSearchClearButton.classList.add("visibility-hidden"),this.$modalSearchInput.value="",t.classList.add("hide"),t.querySelector(this.modalSearchNoResultsSelector).classList.add("hide")},modalSearchAction:function(e,t){var s=this,a=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.clearModalResultsItems(t),this.params.q=e,this.params.page=1,this.params.per_page=5,this.params.filters=a,this.getResults(this.apiUrl,"?"+this.prepareQuery(this.params)).then(function(a){s.showModalResultsItems(a.records.page,e,t)},function(){console.error("Swiftype search connection error.")})},showModalResultsItems:function(e,t,s){if(e.length){for(var a=0;a<e.length;a++)this.createModalResultsItem(a,e[a],s);s.querySelector(this.modalSearchSeeAllSelector).classList.remove("hide"),s.querySelector(this.modalSearchSeeAllSelector).setAttribute("href",this.resultsPageUri+"?q="+t+this.getFilterUrlsParam()),s.querySelector(this.modalSearchNoResultsSelector).classList.add("hide"),this.pushEventTrackingDataLayer({event:"view_search_results",event_category:"site search",event_action:"auto search",event_label:t,event_value:undefined,search_term:t,auto_or_serp:"auto"})}else this.clearModalResultsItems(s),s.querySelector(this.modalSearchNoResultsSelector).classList.remove("hide")},createModalResultsItem:function(e,t,s){var a=s.querySelector(".ndx-modal-results__item-"+e),r=a.getElementsByClassName("ndx-modal-results__item-img")[0],n=a.getElementsByClassName("ndx-modal-results__item-content-title")[0],i=a.getElementsByClassName("ndx-modal-results__item-content-date")[0];a.setAttribute("data-href",t.url),t.image?(r.querySelector("img").setAttribute("src",t.image),r.classList.remove("hide")):r.classList.add("hide");var l=!(!t.publication_date||"LandingPage"==t.asset_type)&&new Date(t.publication_date);n.innerHTML=t.title,i.innerHTML=this.getStringDate(l),a.classList.remove("hide")},startModalItemsClickEventListener:function(){var e=arguments.length<=0||arguments[0]===undefined?"ndx-modal-results__item":arguments[0],t=this,s=document.getElementsByClassName(e),a=!0,r=!1,n=undefined;try{for(var i,l=function(){var e=i.value;e.addEventListener("click",function(){var s=e.getAttribute("data-href"),a=e.querySelector(".ndx-modal-results__item-content-title").innerText;t.pushEventTrackingDataLayer({event:"select_search_result",event_category:"site search",event_action:"select auto result",event_label:a,event_value:undefined,suggested_result:a,auto_or_serp:"auto",search_term:t.params.q}).then(function(){window.location.href=s},function(){console.error("Data layer adding error.")})})},o=s[Symbol.iterator]();!(a=(i=o.next()).done);a=!0)l()}catch(e){r=!0,n=e}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw n}}},getStringDate:function(e){return e?e.toLocaleString("default",{month:"short"})+" "+e.getDay()+", "+e.getFullYear()+" "+e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}):""},clearModalResultsItems:function(e){for(var t=undefined,s=0;s<5;s++)t=e.querySelector(".ndx-modal-results__item-"+s),t.classList.add("hide"),t.getElementsByClassName("ndx-modal-results__item-img")[0].classList.add("hide");e.querySelector(this.modalSearchNoResultsSelector).classList.add("hide"),e.querySelector(this.modalSearchSeeAllSelector).classList.add("hide")},openAllResultsPage:function(){window.location.href=this.resultsPageUri+"?q="+this.params.q+this.getFilterUrlsParam()},getFilterUrlsParam:function(){return this.params.filters.page?"&filter=learning":""},prepareQuery:function(e){var t=this;return Object.keys(e).map(function(s){if(t.isObject(e[s])){var a="";for(var r in e[s])if(e[s].hasOwnProperty(r))for(var n in e[s][r])if(e[s][r].hasOwnProperty(n)&&!t.isEmptyObject(e[s][r][n])){var i=s+"["+r+"]["+n+"]";a=t.handleParams(e[s][r][n],a,i)}return a=a.substring(0,a.length-1)}return encodeURIComponent(s)+"="+encodeURIComponent(e[s])}).join("&")},isObject:function(e){return"object"==typeof e&&null!==e},isEmptyObject:function(e){return JSON.stringify(e)===JSON.stringify({})},handleParams:function(e,t,s){if(Array.isArray(e)){var a=e.map(function(e){return s+"[]="+e+"&"}).join("");return""+t+a}if(this.isObject(e)){var a=Object.entries(e).map(function(e){var t=_slicedToArray(e,2),a=t[0],r=t[1];return s+"["+a+"]="+r+"&"}).join("");return""+t+a}return""+t+s+"="+e+"&"},checkIfkeyCodeException:function(e){return this.keyCodeExceptions.includes(e)},stripHtml:function(e){return $($.parseHTML(e)).text()},pushEventTrackingDataLayer:function(e){return new Promise(function(t){google360.sendEvent(e),t(!0)})}};swiftypeSearchApp.run();